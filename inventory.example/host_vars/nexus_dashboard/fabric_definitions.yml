---
# Fabric Definitions - EXAMPLE
# Copy to inventory/host_vars/nexus_dashboard/fabric_definitions.yml
#
# FABRIC_TYPE controls both the API path and module used:
#
#   classicLan    → cisco.dcnm.dcnm_fabric module (state: merged)
#                   Supports POAP/DHCP bootstrap, in-band management
#
#   enhancedLan   → cisco.nd.nd_rest (REST API)
#                   POST /api/v1/manage/fabrics         (create)
#                   PUT  /api/v1/manage/fabrics/{name}  (update)
#                   Requires BGP_AS and VRF_LITE_PROTOCOL

nd_fabrics:
  # --- Classic LAN fabric (supports POAP / DHCP bootstrap) ---
  - FABRIC_NAME: my-fabric
    FABRIC_TYPE: classicLan
    IS_READ_ONLY: false
    PM_ENABLE: true
    INBAND_MGMT: true
    BOOTSTRAP_ENABLE: true
    DHCP_ENABLE: true
    DHCP_START: 10.0.0.100
    DHCP_END: 10.0.0.110
    ENABLE_NXAPI: false
    INBAND_ENABLE: true
    MGMT_GW: 10.0.0.1
    MGMT_PREFIX: 24

  # --- Enhanced LAN fabric (uses REST API, no POAP/DHCP support) ---
  - FABRIC_NAME: my-enhanced-fabric
    FABRIC_TYPE: enhancedLan       # Uses REST API: POST/PUT /api/v1/manage/fabrics
    IS_READ_ONLY: false
    PM_ENABLE: true
    ENABLE_NXAPI: false
    BGP_AS: "65000"                # BGP ASN for management plane (required)
    VRF_LITE_PROTOCOL: "ebgp"      # VRF-Lite protocol: ebgp | static
    # LICENSE_TIER: essentials     # essentials | advantage | premier (default: essentials)
    # SECURITY_DOMAIN: all         # ND security domain (default: all)

vpc_domains:
  - FABRIC_NAME: my-fabric
    DOMAIN_ID: 100
    PEER1_NAME: agg01
    PEER2_NAME: agg02
    PEER1_KEEP_ALIVE_LOCAL_IP: 10.0.1.1
    PEER2_KEEP_ALIVE_LOCAL_IP: 10.0.1.2
    KEEPALIVE_VRF: management
    PEER1_KEEPALIVE_IP: 10.0.1.2
    PEER1_PCID: 100
    PEER1_PC_DESCRIPTION: "VPC Peer-Channel on agg01"
    PEER1_MEMBER_INTERFACES:
      - Ethernet1/47
      - Ethernet1/48
    PEER2_KEEPALIVE_IP: 10.0.1.1
    PEER2_PCID: 100
    PEER2_PC_DESCRIPTION: "VPC Peer-Channel on agg02"
    PEER2_MEMBER_INTERFACES:
      - Ethernet1/47
      - Ethernet1/48
    ALLOWED_VLANS: "2,100-199,999"
    PEER1_NATIVE_VLAN: 2
    PEER2_NATIVE_VLAN: 2
