{#
================================================================================
Template: VLAN Policy Configuration for Nexus Dashboard
================================================================================
Purpose:
  Generate policy configuration in YAML format for deploying VLANs to switches
  via Nexus Dashboard's dcnm_policy module.

Input Variables (from playbook loop):
  item.vlan_id    - VLAN ID number (e.g., 100)
  item.name       - VLAN name (e.g., "10.175.1.0/24_NetworkInfra")
  item.switches   - List of switch IP addresses where VLAN should be created

Output Structure:
  A list containing a single policy object with:
    - name: Policy template name on Nexus Dashboard (must exist)
    - priority: Policy priority (higher = more important)
    - policy_vars: Variables passed to the policy template
    - switch: List of switches to apply the policy to

Notes:
  - The 'create_vlan' policy template must exist on Nexus Dashboard
  - Policy template should use {{VLAN}} and {{NAME}} variables
  - create_additional_policy: false means don't auto-create related policies
  - Each VLAN is processed independently in the playbook loop
================================================================================
#}
{# Main policy configuration structure #}
- name: create_vlan                          # Policy template name on ND
  create_additional_policy: false            # Don't auto-create related policies
  priority: 500                              # Policy priority level
  policy_vars:                               # Variables for policy template
    VLAN: "{{ item.vlan_id }}"               # VLAN ID to create
    NAME: "{{ item.name }}"                  # VLAN name/description
  switch:                                    # Target switches for this policy
{% for switch_ip in item.switches %}         {# Loop through all switches that need this VLAN #}
    - ip: {{ switch_ip }}                    # Switch management IP address
{% endfor %}